module cl_cd
    implicit none

	real(8)::col_cy(11)=(/0.,0.2,0.3,0.4,0.5,0.6,0.7,0.75,0.8,0.9,1.0/),&			
    row_cy(39)=(/-180.,-172.5,-161.,-147.,-129.,-49.,-39.,-21.,-16.5,-15.,&			
            -14., -13.,   -12., -11., -10., -8., -6., -4., -2.,   0.,&
            2.,    4.,     6.,   8.,   10.,  11., 12., 13., 14.,  15.,&
            16.5, 21.,    39.,  49.,  129., 147.,161.,172.5,180./),&
    col_cx(11)=(/0.,0.18,0.28,0.38,0.48,0.62,0.72,0.77,0.82,0.92, 1./),&
    row_cx(65)=(/-180.,-175.,-170.,-165.,-160.,-140.,-120.,-110.,-100.,-90.,-80.,-70.,-60.,-50.,-30.,&
            -21., -16., -15., -14., -13., -12., -11., -10.,  -9., -8., -7., -6., -5., -4., -3.,&
            -2.,  -1.,   0.,   1.,   2.,   3.,   4.,   5.,    6.,  7.,  8.,  9., 10., 11., 12.,&
            13.,  14.,   15.,  16.,  21.,  30.,  50.,  60.,   70., 80., 90., 100.,110.,120.,140.,&
            160., 165., 170., 175., 180./)
	!real(8)::data_cy(39,11),data_cx(65,11)
	real(8)::data_cx(65,11)=(/&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3920, 0.5620, 0.3320, 0.1550, 0.1020, 0.0380, 0.0264, 0.0220, 0.0196, 0.0174, 0.0154, 0.0138, 0.0122, 0.0110, 0.0100, 0.0093, 0.0088, 0.0085, 0.0083, 0.0080, 0.0083, 0.0085, 0.0088, 0.0093, 0.0100, 0.0110, 0.0122, 0.0138, 0.0154, 0.0174, 0.0196, 0.0220, 0.0264, 0.0380, 0.1020, 0.1550, 0.3320, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  ,&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3920, 0.5620, 0.3320, 0.1550, 0.1020, 0.0380, 0.0264, 0.0220, 0.0196, 0.0174, 0.0154, 0.0138, 0.0122, 0.0110, 0.0100, 0.0093, 0.0088, 0.0085, 0.0083, 0.0080, 0.0083, 0.0085, 0.0088, 0.0093, 0.0100, 0.0110, 0.0122, 0.0138, 0.0154, 0.0174, 0.0196, 0.0220, 0.0264, 0.0380, 0.1020, 0.1550, 0.3320, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  ,&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3920, 0.5620, 0.3320, 0.1810, 0.1480, 0.0990, 0.0455, 0.0300, 0.0232, 0.0189, 0.0159, 0.0138, 0.0122, 0.0110, 0.0100, 0.0093, 0.0088, 0.0085, 0.0083, 0.0080, 0.0083, 0.0085, 0.0088, 0.0093, 0.0100, 0.0110, 0.0122, 0.0138, 0.0159, 0.0189, 0.0232, 0.0300, 0.0455, 0.0990, 0.1480, 0.1810, 0.3320, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  ,&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3920, 0.5620, 0.3320, 0.2070, 0.1810, 0.1460, 0.0940, 0.0600, 0.0380, 0.0259, 0.0187, 0.0147, 0.0123, 0.0110, 0.0100, 0.0093, 0.0088, 0.0085, 0.0083, 0.0080, 0.0083, 0.0085, 0.0088, 0.0093, 0.0100, 0.0110, 0.0123, 0.0147, 0.0187, 0.0259, 0.0380, 0.0600, 0.0940, 0.1460, 0.1810, 0.2070, 0.3320, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  ,&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3920, 0.5620, 0.3320, 0.2350, 0.2090, 0.1800, 0.1480, 0.1110, 0.0780, 0.0530, 0.0351, 0.0220, 0.0141, 0.0110, 0.0100, 0.0093, 0.0088, 0.0085, 0.0083, 0.0080, 0.0083, 0.0085, 0.0088, 0.0093, 0.0100, 0.0110, 0.0141, 0.0220, 0.0351, 0.0530, 0.0780, 0.1110, 0.1480, 0.1800, 0.2090, 0.2350, 0.3320, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  ,&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3990, 0.5620, 0.3320, 0.2570, 0.2330, 0.2120, 0.1910, 0.1640, 0.1350, 0.1050, 0.0770, 0.0530, 0.0350, 0.0212, 0.0132, 0.0100, 0.0090, 0.0085, 0.0083, 0.0080, 0.0083, 0.0085, 0.0090, 0.0100, 0.0132, 0.0212, 0.0350, 0.0530, 0.0770, 0.1050, 0.1350, 0.1640, 0.1910, 0.2120, 0.2330, 0.2570, 0.3320, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  ,&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3920, 0.5620, 0.3320, 0.2740, 0.2520, 0.2330, 0.2160, 0.1980, 0.1700, 0.1450, 0.1220, 0.1010, 0.0820, 0.0615, 0.0380, 0.0167, 0.0102, 0.0086, 0.0083, 0.0080, 0.0083, 0.0086, 0.0102, 0.0167, 0.0380, 0.0615, 0.0820, 0.1010, 0.1220, 0.1450, 0.1700, 0.1980, 0.2160, 0.2330, 0.2520, 0.2740, 0.3320, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  ,&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3920, 0.5620, 0.3320, 0.2920, 0.2710, 0.2490, 0.2310, 0.2110, 0.1920, 0.1760, 0.1590, 0.1400, 0.1110, 0.0820, 0.0540, 0.0300, 0.0175, 0.0117, 0.0091, 0.0080, 0.0091, 0.0117, 0.0175, 0.0300, 0.0540, 0.0820, 0.1110, 0.1400, 0.1590, 0.1760, 0.1920, 0.2110, 0.2310, 0.2490, 0.2710, 0.2920, 0.3320, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  ,&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3920, 0.5620, 0.3320, 0.3050, 0.2820, 0.2600, 0.2390, 0.2200, 0.2020, 0.1860, 0.1720, 0.1550, 0.1390, 0.1200, 0.0880, 0.0575, 0.0355, 0.0240, 0.0175, 0.0137, 0.0175, 0.0240, 0.0355, 0.0575, 0.0880, 0.1200, 0.1390, 0.1550, 0.1720, 0.1860, 0.2020, 0.2200, 0.2390, 0.2600, 0.2820, 0.3050, 0.3320, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  ,&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3920, 0.5620, 0.3420, 0.3420, 0.2980, 0.2930, 0.2720, 0.2520, 0.2320, 0.2130, 0.1990, 0.1830, 0.1690, 0.1400, 0.1110, 0.0950, 0.0860, 0.0810, 0.0780, 0.0780, 0.0780, 0.0810, 0.0860, 0.0950, 0.1110, 0.1400, 0.1690, 0.1830, 0.1990, 0.2130, 0.2320, 0.2520, 0.2720, 0.2930, 0.2980, 0.3420, 0.3420, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  ,&
			0.0220, 0.0620, 0.1320, 0.2420, 0.3020, 1.0420, 1.6520, 1.8520, 2.0220, 2.0220, 1.9620, 1.8420, 1.6620, 1.3920, 0.5620, 0.3420, 0.3420, 0.2980, 0.2930, 0.2920, 0.2910, 0.2750, 0.2540, 0.2320, 0.2140, 0.1920, 0.1700, 0.1400, 0.1120, 0.1020, 0.0980, 0.0960, 0.0950, 0.0960, 0.0980, 0.1020, 0.1120, 0.1400, 0.1700, 0.1920, 0.2140, 0.2320, 0.2540, 0.2750, 0.2910, 0.2920, 0.2930, 0.2980, 0.3420, 0.3420, 0.5620, 1.3920, 1.6620, 1.8420, 1.9620, 2.0220, 2.0220, 1.8520, 1.6520, 1.0420, 0.3020, 0.2420, 0.1320, 0.0620, 0.0220  &
			/)
	real(8)::data_cy(39,11)=(/&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.8000,  -1.0070,  -1.1900,  -1.3330,  -1.3340,  -1.2550,  -1.1610,  -1.0550,  -0.8440,  -0.6330,  -0.4220,  -0.2110, 0.0000, 0.2110, 0.4220, 0.6330, 0.8440, 1.0550, 1.1610, 1.2550, 1.3340, 1.3330, 1.1900, 1.0070, 0.8000, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  ,&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.8000,  -1.0070,  -1.1900,  -1.3330,  -1.3340,  -1.2550,  -1.1610,  -1.0550,  -0.8440,  -0.6330,  -0.4220,  -0.2110, 0.0000, 0.2110, 0.4220, 0.6330, 0.8440, 1.0550, 1.1610, 1.2550, 1.3340, 1.3330, 1.1900, 1.0070, 0.8000, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  ,&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.8100,  -0.9440,  -1.0900,  -1.2200,  -1.2800,  -1.2600,  -1.1900,  -1.0100,  -0.8800,  -0.6600,  -0.4400,  -0.2200, 0.0000, 0.2200, 0.4400, 0.6600, 0.8800, 1.1000, 1.1900, 1.2600, 1.2800, 1.2200, 1.0900, 0.9440, 0.8100, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  ,&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.8300,  -0.9600,  -1.0550,  -1.0960,  -1.1200,  -1.1300,  -1.1200,  -1.0820,  -0.9070,  -0.6840,  -0.4560,  -0.2280, 0.0000, 0.2280, 0.4560, 0.6840, 0.9070, 1.0820, 1.1200, 1.1300, 1.1200, 1.0960, 1.0550, 0.9600, 0.8300, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  ,&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.8500,  -0.9650,  -0.9900,  -1.0000,  -1.0000,  -1.0000,  -0.9940,  -0.9850,  -0.9220,  -0.7410,  -0.4940,  -0.2470, 0.0000, 0.2470, 0.4940, 0.7410, 0.9220, 0.9850, 0.9940, 1.0000, 1.0000, 1.0000, 0.9900, 0.9650, 0.8500, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  ,&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.8500,  -0.9650,  -0.9800,  -0.9700,  -0.9600,  -0.9470,  -0.9300,  -0.9100,  -0.8700,  -0.7700,  -0.5440,  -0.2720, 0.0000, 0.2720, 0.5440, 0.7700, 0.8700, 0.9100, 0.9300, 0.9470, 0.9600, 0.9700, 0.9800, 0.9650, 0.8500, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  ,&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.8500,  -0.9650,  -0.9800,  -0.9700,  -0.9600,  -0.9400,  -0.9230,  -0.9000,  -0.8400,  -0.7500,  -0.5780,  -0.3130, 0.0000, 0.3130, 0.5780, 0.7500, 0.8400, 0.9000, 0.9230, 0.9400, 0.9600, 0.9700, 0.9800, 0.9650, 0.8500, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  ,&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.7100,  -0.7950,  -0.8300,  -0.8400,  -0.8500,  -0.8500,  -0.8500,  -0.8450,  -0.8200,  -0.7700,  -0.6270,  -0.3500, 0.0000, 0.3500, 0.6270, 0.7700, 0.8200, 0.8450, 0.8500, 0.8500, 0.8500, 0.8400, 0.8300, 0.7950, 0.7100, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  ,&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.6800,  -0.7600,  -0.7900,  -0.8050,  -0.8150,  -0.8200,  -0.8100,  -0.8050,  -0.7700,  -0.7200,  -0.6030,  -0.3950, 0.0000, 0.3950, 0.6030, 0.7200, 0.7700, 0.8050, 0.8100, 0.8200, 0.8150, 0.8050, 0.7900, 0.7600, 0.6800, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  ,&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.6400,  -0.7000,  -0.7200,  -0.7300,  -0.7350,  -0.7400,  -0.7400,  -0.7300,  -0.6950,  -0.5930,  -0.3960,  -0.2000, 0.0000, 0.2000, 0.3960, 0.5930, 0.6950, 0.7300, 0.7400, 0.7400, 0.7350, 0.7300, 0.7300, 0.7000, 0.6400, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  ,&
			0.0000, 0.7800, 0.6200, 1.0000, 1.0000,  -1.1800,  -1.1800,  -0.6400,  -0.7000,  -0.7200,  -0.7300,  -0.7350,  -0.7400,  -0.7400,  -0.7300,  -0.6950,  -0.5930,  -0.3960,  -0.2000, 0.0000, 0.2000, 0.3960, 0.5930, 0.6950, 0.7300, 0.7400, 0.7400, 0.7350, 0.7300, 0.7300, 0.7000, 0.6400, 1.1800, 1.1800,  -1.0000,  -1.0000,  -0.6200,  -0.7800, 0.0000  &
			/)
	!
	contains
    !***********************************************************************************
	function get_point4(p1,p2,p3,p4,xyz)
		implicit none
		real(8)::p1(3),p2(3),p3(3),p4(3),xyz(2),p12,p34,get_point4
		p12=p1(3)+(p2(3)-p1(3))*(xyz(1)-p1(1))/(p2(1)-p1(1))
		p34=p3(3)+(p4(3)-p3(3))*(xyz(1)-p3(1))/(p4(1)-p3(1))
		get_point4=p12+(p34-p12)*(xyz(2)-p1(2))/(p3(2)-p1(2))
		
		return
	end function get_point4
	
    function rcl(alpha,v)
        implicit none
        real(8),parameter::ep=0.01
        real(8)::alpha,v,ma,rcl
		real(8)::p1(3),p2(3),p3(3),p4(3),pp(2)
        integer::f1,f2,f3,f4
		integer::i
        ma=v/340.0
		f1=1;f2=2
		!f3=20;f4=21

        if(abs(ma)<ep)then
            f1=1;f2=2
        else if(abs(ma-1.0)<ep)then
            f1=10;f2=11
        else
            do i=1,10,1
                if((ma>col_cy(i)).and.(ma<=col_cy(i+1)))then
                    f1=i;f2=i+1
                    exit
                end if
            end do
		end if

        if(abs(alpha+180.0)<ep)then
            f3=1;f4=2
        else if(abs(alpha-180.0)<ep)then
            f3=38;f4=39
        else
            do i=1,38,1
                if((alpha>row_cy(i)).and.(alpha<=row_cy(i+1)))then
                    f3=i;f4=i+1
                    exit
                end if
            end do
		end if
		if((f1<1).or.(f2>11).or.(f3<1).or.(f4>39)) then
			write(*,*)'Wrong in cl(39,11)'
			write(*,*)'alpha,v',alpha,v
			write(*,*)f1,f2,f3,f4
			pause
			stop
		end if

		p1=(/col_cy(f1),row_cy(f3),data_cy(f3,f1)/)
		p2=(/col_cy(f2),row_cy(f3),data_cy(f3,f2)/)
		p3=(/col_cy(f1),row_cy(f4),data_cy(f4,f1)/)
		p4=(/col_cy(f2),row_cy(f4),data_cy(f4,f2)/)
		pp=(/ma,alpha/)
	
		rcl=get_point4(p1,p2,p3,p4,pp)
		return
	end function rcl
	
	function rcd(alpha,v)
        implicit none
        real(8),parameter::ep=0.01
        real(8)::alpha,v,ma,rcd
		real(8)::p1(3),p2(3),p3(3),p4(3),pp(2)
        integer::f1,f2,f3,f4
		integer::i
        ma=v/340.0
		f1=1;f2=2

        if(abs(ma)<ep)then
            f1=1;f2=2
        else if(abs(ma-1.0)<ep)then
            f1=10;f2=11
        else
            do i=1,10,1
                if((ma>col_cx(i)).and.(ma<=col_cx(i+1)))then
                    f1=i;f2=i+1
                    exit
                end if
            end do
        end if

        if(abs(alpha+180.0)<ep)then
            f3=1;f4=2
        else if(abs(alpha-180.0)<ep)then
            f3=64;f4=65
        else
            do i=1,64,1
                if((alpha>row_cx(i)).and.(alpha<=row_cx(i+1)))then
                    f3=i;f4=i+1
                    exit
                end if
            end do
		end if
		if((f1<1).or.(f2>11).or.(f3<1).or.(f4>65)) then	
			write(*,*)'Wrong in cl(65,11)'
			write(*,*)'alpha,v',alpha,v
			write(*,*)f1,f2,f3,f4
			pause
			stop
		end if

		p1=(/col_cx(f1),row_cx(f3),data_cx(f3,f1)/)
		p2=(/col_cx(f2),row_cx(f3),data_cx(f3,f2)/)
		p3=(/col_cx(f1),row_cx(f4),data_cx(f4,f1)/)
		p4=(/col_cx(f2),row_cx(f4),data_cx(f4,f2)/)
		pp=(/ma,alpha/)
		rcd=get_point4(p1,p2,p3,p4,pp)
		return
    end function rcd
end module cl_cd